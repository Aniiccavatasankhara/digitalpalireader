revamped engine, probably fixed some bugs too
